Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.125    0.125  297.102  297.102 /home/leo/usman_ws/codes/Patch-NetVLAD/patchnetvlad/training_tools/train_epoch.py:95(train_epoch)
271491/713    0.378    0.000  252.821    0.355 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/nn/modules/module.py:1188(_call_impl)
      713    0.031    0.000  252.813    0.355 /home/leo/usman_ws/codes/Patch-NetVLAD/patchnetvlad/models/netvlad.py:343(forward)
      713  171.357    0.240  251.622    0.353 /home/leo/usman_ws/codes/Patch-NetVLAD/patchnetvlad/models/netvlad.py:271(forward)
        1    0.008    0.008   65.998   65.998 /home/leo/usman_ws/codes/Patch-NetVLAD/patchnetvlad/training_tools/msls.py:461(update_subcache)
     1426   37.071    0.026   37.071    0.026 {method 'cuda' of 'torch._C._TensorBase' objects}
     5973    1.892    0.000   26.967    0.005 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torchvision/ops/boxes.py:386(masks_to_boxes)
   113486   23.733    0.000   23.733    0.000 {built-in method torch.where}
      646   20.416    0.032   20.416    0.032 {method 'item' of 'torch._C._TensorBase' objects}
    38877   13.616    0.000   13.616    0.000 {method 'to' of 'torch._C._TensorBase' objects}
      723    0.005    0.000   11.318    0.016 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/tqdm/std.py:1161(__iter__)
      719    0.012    0.000   10.423    0.014 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/utils/data/dataloader.py:623(__next__)
      719    0.004    0.000   10.392    0.014 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/utils/data/dataloader.py:1286(_next_data)


 ncalls  tottime  percall  cumtime  percall filename:lineno(function)
  477/202    0.001    0.000    0.432    0.002 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/nn/modules/module.py:1188(_call_impl)
       95    0.000    0.000    0.297    0.003 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/nn/modules/conv.py:462(forward)
       95    0.000    0.000    0.297    0.003 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/nn/modules/conv.py:454(_conv_forward)
       95    0.297    0.003    0.297    0.003 {built-in method torch.conv2d}
        1    0.000    0.000    0.255    0.255 /home/leo/usman_ws/codes/Patch-NetVLAD/patchnetvlad/models/espnet.py:355(forward)
        4    0.000    0.000    0.184    0.046 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/nn/modules/container.py:202(forward)
        1    0.000    0.000    0.147    0.147 /home/leo/usman_ws/codes/Patch-NetVLAD/patchnetvlad/models/vgg.py:62(forward)
        2    0.000    0.000    0.132    0.066 /home/leo/usman_ws/codes/Patch-NetVLAD/patchnetvlad/models/espnet.py:29(forward)
    44/24    0.000    0.000    0.059    0.002 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/_jit_internal.py:475(fn)
       20    0.006    0.000    0.051    0.003 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torchvision/ops/boxes.py:386(masks_to_boxes)
        2    0.042    0.021    0.042    0.021 {method 'cuda' of 'torch._C._TensorBase' objects}
        2    0.003    0.002    0.039    0.020 /home/leo/usman_ws/codes/Patch-NetVLAD/patchnetvlad/models/espnet.py:151(forward)
       20    0.000    0.000    0.038    0.002 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/_tensor.py:791(unique)
       20    0.000    0.000    0.038    0.002 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/functional.py:861(_return_counts)
       20    0.000    0.000    0.038    0.002 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/functional.py:714(_unique_impl)
       20    0.038    0.002    0.038    0.002 {built-in method torch._unique2}
       40    0.036    0.001    0.036    0.001 {built-in method torch.argsort}
        3    0.000    0.000    0.034    0.011 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/nn/modules/conv.py:944(forward)
        3    0.034    0.011    0.034    0.011 {built-in method torch.conv_transpose2d}
       65    0.000    0.000    0.034    0.001 /home/leo/usman_ws/codes/Patch-NetVLAD/patchnetvlad/models/espnet.py:129(forward)
      200    0.000    0.000    0.029    0.000 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torchvision/transforms/transforms.py:338(forward)
      200    0.000    0.000    0.029    0.000 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torchvision/transforms/functional.py:388(resize)
      760    0.028    0.000    0.028    0.000 {built-in method torch.max}
      200    0.000    0.000    0.028    0.000 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torchvision/transforms/functional_tensor.py:447(resize)
        2    0.000    0.000    0.028    0.014 /home/leo/usman_ws/codes/Patch-NetVLAD/patchnetvlad/models/espnet.py:240(forward)
        3    0.000    0.000    0.028    0.009 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/nn/modules/pooling.py:626(forward)
        3    0.028    0.009    0.028    0.009 {built-in method torch._C._nn.avg_pool2d}
      200    0.000    0.000    0.027    0.000 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/nn/functional.py:3769(interpolate)
      200    0.026    0.000    0.026    0.000 {built-in method torch._C._nn.upsample_bilinear2d}
        4    0.000    0.000    0.021    0.005 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/nn/modules/pooling.py:165(forward)
        4    0.000    0.000    0.021    0.005 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/nn/functional.py:760(_max_pool2d)
        4    0.021    0.005    0.021    0.005 {built-in method torch.max_pool2d}
       15    0.000    0.000    0.018    0.001 /home/leo/usman_ws/codes/Patch-NetVLAD/patchnetvlad/models/espnet.py:104(forward)
       11    0.000    0.000    0.017    0.002 /home/leo/usman_ws/codes/Patch-NetVLAD/patchnetvlad/models/espnet.py:195(forward)
      380    0.011    0.000    0.011    0.000 {built-in method torch.where}
       22    0.010    0.000    0.010    0.000 {built-in method torch.zeros}
       20    0.000    0.000    0.008    0.000 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/nn/modules/activation.py:1239(forward)
       20    0.008    0.000    0.008    0.000 {built-in method torch.prelu}
        1    0.006    0.006    0.006    0.006 {method 'max' of 'torch._C._TensorBase' objects}
       12    0.000    0.000    0.006    0.000 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/nn/modules/activation.py:101(forward)



ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    246/1    0.001    0.000    0.230    0.230 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/nn/modules/module.py:1188(_call_impl)
        1    0.000    0.000    0.230    0.230 /home/leo/usman_ws/codes/Patch-NetVLAD/patchnetvlad/models/espnet.py:355(forward)
       82    0.000    0.000    0.159    0.002 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/nn/modules/conv.py:462(forward)
       82    0.000    0.000    0.159    0.002 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/nn/modules/conv.py:454(_conv_forward)
       82    0.159    0.002    0.159    0.002 {built-in method torch.conv2d}
        2    0.000    0.000    0.119    0.060 /home/leo/usman_ws/codes/Patch-NetVLAD/patchnetvlad/models/espnet.py:29(forward)
        2    0.003    0.001    0.036    0.018 /home/leo/usman_ws/codes/Patch-NetVLAD/patchnetvlad/models/espnet.py:151(forward)
        3    0.000    0.000    0.033    0.011 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/nn/modules/container.py:202(forward)
       65    0.000    0.000    0.032    0.000 /home/leo/usman_ws/codes/Patch-NetVLAD/patchnetvlad/models/espnet.py:129(forward)
        3    0.000    0.000    0.031    0.010 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/nn/modules/conv.py:944(forward)
        3    0.031    0.010    0.031    0.010 {built-in method torch.conv_transpose2d}
        2    0.000    0.000    0.024    0.012 /home/leo/usman_ws/codes/Patch-NetVLAD/patchnetvlad/models/espnet.py:240(forward)
        3    0.000    0.000    0.024    0.008 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/nn/modules/pooling.py:626(forward)
        3    0.024    0.008    0.024    0.008 {built-in method torch._C._nn.avg_pool2d}
       15    0.000    0.000    0.016    0.001 /home/leo/usman_ws/codes/Patch-NetVLAD/patchnetvlad/models/espnet.py:104(forward)
       11    0.000    0.000    0.015    0.001 /home/leo/usman_ws/codes/Patch-NetVLAD/patchnetvlad/models/espnet.py:195(forward)
       20    0.000    0.000    0.005    0.000 /home/leo/anaconda3/envs/patchnetvlad/lib/python3.9/site-packages/torch/nn/modules/activation.py:1239(forward)
       20    0.005    0.000    0.005    0.000 {built-in method torch.prelu}