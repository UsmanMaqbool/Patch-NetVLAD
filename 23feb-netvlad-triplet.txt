/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/model_best.pth.tar
/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch2.pth.tar
/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch1.pth.tar
Building PCA Model of /home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/model_best.pth.tar file...
/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar
model_best
Skipping the addition of the PCA layer as /home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar already exists.
Extracting Features of mapillarysf Index Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarysf_imageNames_index.txt', dataset_root_dir='/home/leo/usman_ws/datasets/', output_features_dir='/home/leo/usman_ws/models/patch-netvlad/mapillarysf_index', nocuda=False, resume_path='/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 6315 images
=> loading checkpoint '/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar'
Creating model graphvladpca
Encoder loaded!
=> loaded checkpoint '/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar'
====> Extracting Features
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])
torch.Size([5, 8192])


Done. Finished extracting and saving features
Extracting Features of mapillarysf Query Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarysf_imageNames_query.txt', dataset_root_dir='/home/leo/usman_ws/datasets/', output_features_dir='/home/leo/usman_ws/models/patch-netvlad/mapillarysf_query', nocuda=False, resume_path='/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 242 images
=> loading checkpoint '/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar'
Creating model graphvladpca
Encoder loaded!
=> loaded checkpoint '/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Performing Features Matching and Recall Result of mapillarysf
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_root_dir='/home/leo/usman_ws/datasets/', query_file_path='mapillarysf_imageNames_query.txt', index_file_path='mapillarysf_imageNames_index.txt', query_input_features_dir='/home/leo/usman_ws/models/patch-netvlad/mapillarysf_query', index_input_features_dir='/home/leo/usman_ws/models/patch-netvlad/mapillarysf_index', ground_truth_path=None, result_save_folder='./patchnetvlad/results/mapillarysf', posDistThr=None, nocuda=False)
Parsing dataset...
Done! Found 242 images
Parsing dataset...
Done! Found 6315 images
====> Building faiss index
Writing results to ./patchnetvlad/results/mapillarysf/NetVLAD_predictions.txt
Finished matching features.
No ground truth was provided; not calculating recalls.
Done
Extracting Features of mapillarycph Index Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarycph_imageNames_index.txt', dataset_root_dir='/home/leo/usman_ws/datasets/', output_features_dir='/home/leo/usman_ws/models/patch-netvlad/mapillarycph_index', nocuda=False, resume_path='/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 12556 images
=> loading checkpoint '/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar'
Creating model graphvladpca
Encoder loaded!
=> loaded checkpoint '/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Extracting Features of mapillarycph Query Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarycph_imageNames_query.txt', dataset_root_dir='/home/leo/usman_ws/datasets/', output_features_dir='/home/leo/usman_ws/models/patch-netvlad/mapillarycph_query', nocuda=False, resume_path='/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 498 images
=> loading checkpoint '/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar'
Creating model graphvladpca
Encoder loaded!
=> loaded checkpoint '/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Performing Features Matching and Recall Result of mapillarycph
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_root_dir='/home/leo/usman_ws/datasets/', query_file_path='mapillarycph_imageNames_query.txt', index_file_path='mapillarycph_imageNames_index.txt', query_input_features_dir='/home/leo/usman_ws/models/patch-netvlad/mapillarycph_query', index_input_features_dir='/home/leo/usman_ws/models/patch-netvlad/mapillarycph_index', ground_truth_path=None, result_save_folder='./patchnetvlad/results/mapillarycph', posDistThr=None, nocuda=False)
Parsing dataset...
Done! Found 498 images
Parsing dataset...
Done! Found 12556 images
====> Building faiss index
Writing results to ./patchnetvlad/results/mapillarycph/NetVLAD_predictions.txt
Finished matching features.
No ground truth was provided; not calculating recalls.
Done
Recall Results of /home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar file...
Ignoring sequence length 3 for the im2im task. (Setting to 1)
=====> cph
=====> sf
all_recall@1: 0.670
all_recall@5: 0.786
all_recall@10: 0.830
all_recall@20: 0.868
all_map@1: 0.670
all_map@5: 0.464
all_map@10: 0.402
all_map@20: 0.385
Building PCA Model of /home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch2.pth.tar file...
/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar
checkpoint_epoch2
Skipping the addition of the PCA layer as /home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar already exists.
Extracting Features of mapillarysf Index Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarysf_imageNames_index.txt', dataset_root_dir='/home/leo/usman_ws/datasets/', output_features_dir='/home/leo/usman_ws/models/patch-netvlad/mapillarysf_index', nocuda=False, resume_path='/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 6315 images
=> loading checkpoint '/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar'
Creating model graphvladpca
Encoder loaded!
=> loaded checkpoint '/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Extracting Features of mapillarysf Query Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarysf_imageNames_query.txt', dataset_root_dir='/home/leo/usman_ws/datasets/', output_features_dir='/home/leo/usman_ws/models/patch-netvlad/mapillarysf_query', nocuda=False, resume_path='/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 242 images
=> loading checkpoint '/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar'
Creating model graphvladpca
Encoder loaded!
=> loaded checkpoint '/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Performing Features Matching and Recall Result of mapillarysf
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_root_dir='/home/leo/usman_ws/datasets/', query_file_path='mapillarysf_imageNames_query.txt', index_file_path='mapillarysf_imageNames_index.txt', query_input_features_dir='/home/leo/usman_ws/models/patch-netvlad/mapillarysf_query', index_input_features_dir='/home/leo/usman_ws/models/patch-netvlad/mapillarysf_index', ground_truth_path=None, result_save_folder='./patchnetvlad/results/mapillarysf', posDistThr=None, nocuda=False)
Parsing dataset...
Done! Found 242 images
Parsing dataset...
Done! Found 6315 images
====> Building faiss index
Writing results to ./patchnetvlad/results/mapillarysf/NetVLAD_predictions.txt
Finished matching features.
No ground truth was provided; not calculating recalls.
Done
Extracting Features of mapillarycph Index Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarycph_imageNames_index.txt', dataset_root_dir='/home/leo/usman_ws/datasets/', output_features_dir='/home/leo/usman_ws/models/patch-netvlad/mapillarycph_index', nocuda=False, resume_path='/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 12556 images
=> loading checkpoint '/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar'
Creating model graphvladpca
Encoder loaded!
=> loaded checkpoint '/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Extracting Features of mapillarycph Query Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarycph_imageNames_query.txt', dataset_root_dir='/home/leo/usman_ws/datasets/', output_features_dir='/home/leo/usman_ws/models/patch-netvlad/mapillarycph_query', nocuda=False, resume_path='/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 498 images
=> loading checkpoint '/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar'
Creating model graphvladpca
Encoder loaded!
=> loaded checkpoint '/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Performing Features Matching and Recall Result of mapillarycph
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_root_dir='/home/leo/usman_ws/datasets/', query_file_path='mapillarycph_imageNames_query.txt', index_file_path='mapillarycph_imageNames_index.txt', query_input_features_dir='/home/leo/usman_ws/models/patch-netvlad/mapillarycph_query', index_input_features_dir='/home/leo/usman_ws/models/patch-netvlad/mapillarycph_index', ground_truth_path=None, result_save_folder='./patchnetvlad/results/mapillarycph', posDistThr=None, nocuda=False)
Parsing dataset...
Done! Found 498 images
Parsing dataset...
Done! Found 12556 images
====> Building faiss index
Writing results to ./patchnetvlad/results/mapillarycph/NetVLAD_predictions.txt
Finished matching features.
No ground truth was provided; not calculating recalls.
Done
Recall Results of /home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar file...
Ignoring sequence length 3 for the im2im task. (Setting to 1)
=====> cph
=====> sf
all_recall@1: 0.688
all_recall@5: 0.803
all_recall@10: 0.843
all_recall@20: 0.872
all_map@1: 0.688
all_map@5: 0.499
all_map@10: 0.438
all_map@20: 0.420
Building PCA Model of /home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch1.pth.tar file...
/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar
checkpoint_epoch1
Skipping the addition of the PCA layer as /home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar already exists.
Extracting Features of mapillarysf Index Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarysf_imageNames_index.txt', dataset_root_dir='/home/leo/usman_ws/datasets/', output_features_dir='/home/leo/usman_ws/models/patch-netvlad/mapillarysf_index', nocuda=False, resume_path='/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 6315 images
=> loading checkpoint '/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar'
Creating model graphvladpca
Encoder loaded!
=> loaded checkpoint '/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Extracting Features of mapillarysf Query Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarysf_imageNames_query.txt', dataset_root_dir='/home/leo/usman_ws/datasets/', output_features_dir='/home/leo/usman_ws/models/patch-netvlad/mapillarysf_query', nocuda=False, resume_path='/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 242 images
=> loading checkpoint '/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar'
Creating model graphvladpca
Encoder loaded!
=> loaded checkpoint '/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Performing Features Matching and Recall Result of mapillarysf
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_root_dir='/home/leo/usman_ws/datasets/', query_file_path='mapillarysf_imageNames_query.txt', index_file_path='mapillarysf_imageNames_index.txt', query_input_features_dir='/home/leo/usman_ws/models/patch-netvlad/mapillarysf_query', index_input_features_dir='/home/leo/usman_ws/models/patch-netvlad/mapillarysf_index', ground_truth_path=None, result_save_folder='./patchnetvlad/results/mapillarysf', posDistThr=None, nocuda=False)
Parsing dataset...
Done! Found 242 images
Parsing dataset...
Done! Found 6315 images
====> Building faiss index
Writing results to ./patchnetvlad/results/mapillarysf/NetVLAD_predictions.txt
Finished matching features.
No ground truth was provided; not calculating recalls.
Done
Extracting Features of mapillarycph Index Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarycph_imageNames_index.txt', dataset_root_dir='/home/leo/usman_ws/datasets/', output_features_dir='/home/leo/usman_ws/models/patch-netvlad/mapillarycph_index', nocuda=False, resume_path='/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 12556 images
=> loading checkpoint '/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar'
Creating model graphvladpca
Encoder loaded!
=> loaded checkpoint '/home/leo/usman_ws/models/patchnetvlad/graphvlad-triplet-20-Feb-netvlad-triplet-cen-map-16-lr0_001/Feb20_09-18-06_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar'
====> Extracting Features
