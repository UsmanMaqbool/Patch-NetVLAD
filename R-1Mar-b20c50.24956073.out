Sat Mar  2 07:32:40 EST 2024
/home/m.maqboolbhutta/usman_ws/codes/patchnetvlad
/home/m.maqboolbhutta/.conda/envs/patchnetvlad/bin/python
Host: c0901a-s17
Other nodes: 
Starting  process(es) on each node...
/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/model_best.pth.tar
/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch1.pth.tar
/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch2.pth.tar
/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch4.pth.tar
/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch5.pth.tar
/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch3.pth.tar
Building PCA Model of /home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/model_best.pth.tar file...
/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar
model_best
Adding PCA Layer
Namespace(config_path='patchnetvlad/configs/train.ini', dataset_choice='mapillary', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/mapillary_sls/', method='netvlad', nocuda=False, resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/model_best.pth.tar', threads=6, vd16_offtheshelf_path=None)
===> Building model
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/model_best.pth.tar'
Creating model embednet
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/model_best.pth.tar'
===> Loading PCA dataset(s)
Exclude panoramas: True
=====> trondheim
=====> london
=====> boston
=====> melbourne
=====> amsterdam
=====> helsinki
=====> tokyo
=====> toronto
=====> saopaulo
=====> moscow
=====> zurich
=====> paris
=====> bangkok
=====> budapest
=====> austin
=====> berlin
=====> ottawa
=====> phoenix
=====> goa
=====> amman
=====> nairobi
=====> manila
===> Do inference to extract features and save them.
====> Extracting Features
Compute 10000 features
===> Compute PCA, takes a while
PCA for 10000 points of dimension 8192 to PCA dimension 4096
Compute 4096 eigenvectors
===> Add PCA Whiten
Done
Extracting Features of mapillarysf Index Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarysf_imageNames_index.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_index', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 6315 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Extracting Features of mapillarysf Query Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarysf_imageNames_query.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_query', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 242 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Performing Features Matching and Recall Result of mapillarysf
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', ground_truth_path=None, index_file_path='mapillarysf_imageNames_index.txt', index_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_index', nocuda=False, posDistThr=None, query_file_path='mapillarysf_imageNames_query.txt', query_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_query', result_save_folder='./patchnetvlad/results/mapillarysf')
Parsing dataset...
Done! Found 242 images
Parsing dataset...
Done! Found 6315 images
====> Building faiss index
Writing results to ./patchnetvlad/results/mapillarysf/NetVLAD_predictions.txt
Finished matching features.
No ground truth was provided; not calculating recalls.
Done
Extracting Features of mapillarycph Index Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarycph_imageNames_index.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_index', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 12556 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Extracting Features of mapillarycph Query Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarycph_imageNames_query.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_query', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 498 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Performing Features Matching and Recall Result of mapillarycph
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', ground_truth_path=None, index_file_path='mapillarycph_imageNames_index.txt', index_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_index', nocuda=False, posDistThr=None, query_file_path='mapillarycph_imageNames_query.txt', query_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_query', result_save_folder='./patchnetvlad/results/mapillarycph')
Parsing dataset...
Done! Found 498 images
Parsing dataset...
Done! Found 12556 images
====> Building faiss index
Writing results to ./patchnetvlad/results/mapillarycph/NetVLAD_predictions.txt
Finished matching features.
No ground truth was provided; not calculating recalls.
Done
Recall Results of /home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/model_best_WPCA4096.pth.tar file...
Ignoring sequence length 3 for the im2im task. (Setting to 1)
=====> cph
=====> sf
all_recall@1: 0.716
all_recall@5: 0.836
all_recall@10: 0.862
all_recall@20: 0.885
all_map@1: 0.716
all_map@5: 0.531
all_map@10: 0.467
all_map@20: 0.450
Building PCA Model of /home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch1.pth.tar file...
/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar
checkpoint_epoch1
Adding PCA Layer
Namespace(config_path='patchnetvlad/configs/train.ini', dataset_choice='mapillary', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/mapillary_sls/', method='netvlad', nocuda=False, resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch1.pth.tar', threads=6, vd16_offtheshelf_path=None)
===> Building model
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch1.pth.tar'
Creating model embednet
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch1.pth.tar'
===> Loading PCA dataset(s)
Exclude panoramas: True
=====> trondheim
=====> london
=====> boston
=====> melbourne
=====> amsterdam
=====> helsinki
=====> tokyo
=====> toronto
=====> saopaulo
=====> moscow
=====> zurich
=====> paris
=====> bangkok
=====> budapest
=====> austin
=====> berlin
=====> ottawa
=====> phoenix
=====> goa
=====> amman
=====> nairobi
=====> manila
===> Do inference to extract features and save them.
====> Extracting Features
Compute 10000 features
===> Compute PCA, takes a while
PCA for 10000 points of dimension 8192 to PCA dimension 4096
Compute 4096 eigenvectors
===> Add PCA Whiten
Done
Extracting Features of mapillarysf Index Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarysf_imageNames_index.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_index', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 6315 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Extracting Features of mapillarysf Query Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarysf_imageNames_query.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_query', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 242 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Performing Features Matching and Recall Result of mapillarysf
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', ground_truth_path=None, index_file_path='mapillarysf_imageNames_index.txt', index_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_index', nocuda=False, posDistThr=None, query_file_path='mapillarysf_imageNames_query.txt', query_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_query', result_save_folder='./patchnetvlad/results/mapillarysf')
Parsing dataset...
Done! Found 242 images
Parsing dataset...
Done! Found 6315 images
====> Building faiss index
Writing results to ./patchnetvlad/results/mapillarysf/NetVLAD_predictions.txt
Finished matching features.
No ground truth was provided; not calculating recalls.
Done
Extracting Features of mapillarycph Index Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarycph_imageNames_index.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_index', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 12556 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Extracting Features of mapillarycph Query Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarycph_imageNames_query.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_query', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 498 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Performing Features Matching and Recall Result of mapillarycph
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', ground_truth_path=None, index_file_path='mapillarycph_imageNames_index.txt', index_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_index', nocuda=False, posDistThr=None, query_file_path='mapillarycph_imageNames_query.txt', query_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_query', result_save_folder='./patchnetvlad/results/mapillarycph')
Parsing dataset...
Done! Found 498 images
Parsing dataset...
Done! Found 12556 images
====> Building faiss index
Writing results to ./patchnetvlad/results/mapillarycph/NetVLAD_predictions.txt
Finished matching features.
No ground truth was provided; not calculating recalls.
Done
Recall Results of /home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch1_WPCA4096.pth.tar file...
Ignoring sequence length 3 for the im2im task. (Setting to 1)
=====> cph
=====> sf
all_recall@1: 0.670
all_recall@5: 0.791
all_recall@10: 0.827
all_recall@20: 0.861
all_map@1: 0.670
all_map@5: 0.472
all_map@10: 0.411
all_map@20: 0.395
Building PCA Model of /home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch2.pth.tar file...
/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar
checkpoint_epoch2
Adding PCA Layer
Namespace(config_path='patchnetvlad/configs/train.ini', dataset_choice='mapillary', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/mapillary_sls/', method='netvlad', nocuda=False, resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch2.pth.tar', threads=6, vd16_offtheshelf_path=None)
===> Building model
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch2.pth.tar'
Creating model embednet
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch2.pth.tar'
===> Loading PCA dataset(s)
Exclude panoramas: True
=====> trondheim
=====> london
=====> boston
=====> melbourne
=====> amsterdam
=====> helsinki
=====> tokyo
=====> toronto
=====> saopaulo
=====> moscow
=====> zurich
=====> paris
=====> bangkok
=====> budapest
=====> austin
=====> berlin
=====> ottawa
=====> phoenix
=====> goa
=====> amman
=====> nairobi
=====> manila
===> Do inference to extract features and save them.
====> Extracting Features
Compute 10000 features
===> Compute PCA, takes a while
PCA for 10000 points of dimension 8192 to PCA dimension 4096
Compute 4096 eigenvectors
===> Add PCA Whiten
Done
Extracting Features of mapillarysf Index Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarysf_imageNames_index.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_index', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 6315 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Extracting Features of mapillarysf Query Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarysf_imageNames_query.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_query', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 242 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Performing Features Matching and Recall Result of mapillarysf
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', ground_truth_path=None, index_file_path='mapillarysf_imageNames_index.txt', index_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_index', nocuda=False, posDistThr=None, query_file_path='mapillarysf_imageNames_query.txt', query_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_query', result_save_folder='./patchnetvlad/results/mapillarysf')
Parsing dataset...
Done! Found 242 images
Parsing dataset...
Done! Found 6315 images
====> Building faiss index
Writing results to ./patchnetvlad/results/mapillarysf/NetVLAD_predictions.txt
Finished matching features.
No ground truth was provided; not calculating recalls.
Done
Extracting Features of mapillarycph Index Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarycph_imageNames_index.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_index', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 12556 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Extracting Features of mapillarycph Query Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarycph_imageNames_query.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_query', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 498 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Performing Features Matching and Recall Result of mapillarycph
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', ground_truth_path=None, index_file_path='mapillarycph_imageNames_index.txt', index_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_index', nocuda=False, posDistThr=None, query_file_path='mapillarycph_imageNames_query.txt', query_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_query', result_save_folder='./patchnetvlad/results/mapillarycph')
Parsing dataset...
Done! Found 498 images
Parsing dataset...
Done! Found 12556 images
====> Building faiss index
Writing results to ./patchnetvlad/results/mapillarycph/NetVLAD_predictions.txt
Finished matching features.
No ground truth was provided; not calculating recalls.
Done
Recall Results of /home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch2_WPCA4096.pth.tar file...
Ignoring sequence length 3 for the im2im task. (Setting to 1)
=====> cph
=====> sf
all_recall@1: 0.697
all_recall@5: 0.796
all_recall@10: 0.828
all_recall@20: 0.868
all_map@1: 0.697
all_map@5: 0.497
all_map@10: 0.432
all_map@20: 0.413
Building PCA Model of /home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch4.pth.tar file...
/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch4_WPCA4096.pth.tar
checkpoint_epoch4
Adding PCA Layer
Namespace(config_path='patchnetvlad/configs/train.ini', dataset_choice='mapillary', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/mapillary_sls/', method='netvlad', nocuda=False, resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch4.pth.tar', threads=6, vd16_offtheshelf_path=None)
===> Building model
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch4.pth.tar'
Creating model embednet
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch4.pth.tar'
===> Loading PCA dataset(s)
Exclude panoramas: True
=====> trondheim
=====> london
=====> boston
=====> melbourne
=====> amsterdam
=====> helsinki
=====> tokyo
=====> toronto
=====> saopaulo
=====> moscow
=====> zurich
=====> paris
=====> bangkok
=====> budapest
=====> austin
=====> berlin
=====> ottawa
=====> phoenix
=====> goa
=====> amman
=====> nairobi
=====> manila
===> Do inference to extract features and save them.
====> Extracting Features
Compute 10000 features
===> Compute PCA, takes a while
PCA for 10000 points of dimension 8192 to PCA dimension 4096
Compute 4096 eigenvectors
===> Add PCA Whiten
Done
Extracting Features of mapillarysf Index Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarysf_imageNames_index.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_index', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch4_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 6315 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch4_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch4_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Extracting Features of mapillarysf Query Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarysf_imageNames_query.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_query', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch4_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 242 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch4_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch4_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Performing Features Matching and Recall Result of mapillarysf
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', ground_truth_path=None, index_file_path='mapillarysf_imageNames_index.txt', index_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_index', nocuda=False, posDistThr=None, query_file_path='mapillarysf_imageNames_query.txt', query_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_query', result_save_folder='./patchnetvlad/results/mapillarysf')
Parsing dataset...
Done! Found 242 images
Parsing dataset...
Done! Found 6315 images
====> Building faiss index
Writing results to ./patchnetvlad/results/mapillarysf/NetVLAD_predictions.txt
Finished matching features.
No ground truth was provided; not calculating recalls.
Done
Extracting Features of mapillarycph Index Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarycph_imageNames_index.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_index', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch4_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 12556 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch4_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch4_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Extracting Features of mapillarycph Query Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarycph_imageNames_query.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_query', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch4_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 498 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch4_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch4_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Performing Features Matching and Recall Result of mapillarycph
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', ground_truth_path=None, index_file_path='mapillarycph_imageNames_index.txt', index_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_index', nocuda=False, posDistThr=None, query_file_path='mapillarycph_imageNames_query.txt', query_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_query', result_save_folder='./patchnetvlad/results/mapillarycph')
Parsing dataset...
Done! Found 498 images
Parsing dataset...
Done! Found 12556 images
====> Building faiss index
Writing results to ./patchnetvlad/results/mapillarycph/NetVLAD_predictions.txt
Finished matching features.
No ground truth was provided; not calculating recalls.
Done
Recall Results of /home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch4_WPCA4096.pth.tar file...
Ignoring sequence length 3 for the im2im task. (Setting to 1)
=====> cph
=====> sf
all_recall@1: 0.716
all_recall@5: 0.836
all_recall@10: 0.862
all_recall@20: 0.885
all_map@1: 0.716
all_map@5: 0.531
all_map@10: 0.467
all_map@20: 0.450
Building PCA Model of /home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch5.pth.tar file...
/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch5_WPCA4096.pth.tar
checkpoint_epoch5
Adding PCA Layer
Namespace(config_path='patchnetvlad/configs/train.ini', dataset_choice='mapillary', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/mapillary_sls/', method='netvlad', nocuda=False, resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch5.pth.tar', threads=6, vd16_offtheshelf_path=None)
===> Building model
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch5.pth.tar'
Creating model embednet
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch5.pth.tar'
===> Loading PCA dataset(s)
Exclude panoramas: True
=====> trondheim
=====> london
=====> boston
=====> melbourne
=====> amsterdam
=====> helsinki
=====> tokyo
=====> toronto
=====> saopaulo
=====> moscow
=====> zurich
=====> paris
=====> bangkok
=====> budapest
=====> austin
=====> berlin
=====> ottawa
=====> phoenix
=====> goa
=====> amman
=====> nairobi
=====> manila
===> Do inference to extract features and save them.
====> Extracting Features
Compute 10000 features
===> Compute PCA, takes a while
PCA for 10000 points of dimension 8192 to PCA dimension 4096
Compute 4096 eigenvectors
===> Add PCA Whiten
Done
Extracting Features of mapillarysf Index Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarysf_imageNames_index.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_index', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch5_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 6315 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch5_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch5_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Extracting Features of mapillarysf Query Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarysf_imageNames_query.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_query', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch5_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 242 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch5_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch5_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Performing Features Matching and Recall Result of mapillarysf
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', ground_truth_path=None, index_file_path='mapillarysf_imageNames_index.txt', index_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_index', nocuda=False, posDistThr=None, query_file_path='mapillarysf_imageNames_query.txt', query_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_query', result_save_folder='./patchnetvlad/results/mapillarysf')
Parsing dataset...
Done! Found 242 images
Parsing dataset...
Done! Found 6315 images
====> Building faiss index
Writing results to ./patchnetvlad/results/mapillarysf/NetVLAD_predictions.txt
Finished matching features.
No ground truth was provided; not calculating recalls.
Done
Extracting Features of mapillarycph Index Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarycph_imageNames_index.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_index', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch5_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 12556 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch5_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch5_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Extracting Features of mapillarycph Query Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarycph_imageNames_query.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_query', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch5_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 498 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch5_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch5_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Performing Features Matching and Recall Result of mapillarycph
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', ground_truth_path=None, index_file_path='mapillarycph_imageNames_index.txt', index_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_index', nocuda=False, posDistThr=None, query_file_path='mapillarycph_imageNames_query.txt', query_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_query', result_save_folder='./patchnetvlad/results/mapillarycph')
Parsing dataset...
Done! Found 498 images
Parsing dataset...
Done! Found 12556 images
====> Building faiss index
Writing results to ./patchnetvlad/results/mapillarycph/NetVLAD_predictions.txt
Finished matching features.
No ground truth was provided; not calculating recalls.
Done
Recall Results of /home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch5_WPCA4096.pth.tar file...
Ignoring sequence length 3 for the im2im task. (Setting to 1)
=====> cph
=====> sf
all_recall@1: 0.714
all_recall@5: 0.832
all_recall@10: 0.862
all_recall@20: 0.886
all_map@1: 0.714
all_map@5: 0.532
all_map@10: 0.472
all_map@20: 0.452
Building PCA Model of /home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch3.pth.tar file...
/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch3_WPCA4096.pth.tar
checkpoint_epoch3
Adding PCA Layer
Namespace(config_path='patchnetvlad/configs/train.ini', dataset_choice='mapillary', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/mapillary_sls/', method='netvlad', nocuda=False, resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch3.pth.tar', threads=6, vd16_offtheshelf_path=None)
===> Building model
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch3.pth.tar'
Creating model embednet
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch3.pth.tar'
===> Loading PCA dataset(s)
Exclude panoramas: True
=====> trondheim
=====> london
=====> boston
=====> melbourne
=====> amsterdam
=====> helsinki
=====> tokyo
=====> toronto
=====> saopaulo
=====> moscow
=====> zurich
=====> paris
=====> bangkok
=====> budapest
=====> austin
=====> berlin
=====> ottawa
=====> phoenix
=====> goa
=====> amman
=====> nairobi
=====> manila
===> Do inference to extract features and save them.
====> Extracting Features
Compute 10000 features
===> Compute PCA, takes a while
PCA for 10000 points of dimension 8192 to PCA dimension 4096
Compute 4096 eigenvectors
===> Add PCA Whiten
Done
Extracting Features of mapillarysf Index Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarysf_imageNames_index.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_index', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch3_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 6315 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch3_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch3_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Extracting Features of mapillarysf Query Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarysf_imageNames_query.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_query', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch3_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 242 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch3_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch3_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Performing Features Matching and Recall Result of mapillarysf
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', ground_truth_path=None, index_file_path='mapillarysf_imageNames_index.txt', index_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_index', nocuda=False, posDistThr=None, query_file_path='mapillarysf_imageNames_query.txt', query_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarysf_query', result_save_folder='./patchnetvlad/results/mapillarysf')
Parsing dataset...
Done! Found 242 images
Parsing dataset...
Done! Found 6315 images
====> Building faiss index
Writing results to ./patchnetvlad/results/mapillarysf/NetVLAD_predictions.txt
Finished matching features.
No ground truth was provided; not calculating recalls.
Done
Extracting Features of mapillarycph Index Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarycph_imageNames_index.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_index', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch3_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 12556 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch3_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch3_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Extracting Features of mapillarycph Query Images
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_file_path='mapillarycph_imageNames_query.txt', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', method='netvlad', nocuda=False, output_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_query', resume_path='/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch3_WPCA4096.pth.tar')
Parsing dataset...
Done! Found 498 images
=> loading checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch3_WPCA4096.pth.tar'
Creating model embednetpca
=> loaded checkpoint '/home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch3_WPCA4096.pth.tar'
====> Extracting Features


Done. Finished extracting and saving features
Performing Features Matching and Recall Result of mapillarycph
Namespace(config_path='patchnetvlad/configs/performance.ini', dataset_root_dir='/home/m.maqboolbhutta/usman_ws/datasets/', ground_truth_path=None, index_file_path='mapillarycph_imageNames_index.txt', index_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_index', nocuda=False, posDistThr=None, query_file_path='mapillarycph_imageNames_query.txt', query_input_features_dir='/home/m.maqboolbhutta/usman_ws/models/features/mapillarycph_query', result_save_folder='./patchnetvlad/results/mapillarycph')
Parsing dataset...
Done! Found 498 images
Parsing dataset...
Done! Found 12556 images
====> Building faiss index
Writing results to ./patchnetvlad/results/mapillarycph/NetVLAD_predictions.txt
Finished matching features.
No ground truth was provided; not calculating recalls.
Done
Recall Results of /home/m.maqboolbhutta/usman_ws/models/patchnetvlad/01-Mar-netvlad-triplet-b24c100-lr001/Mar01_08-27-50_mapillary_nopanos/checkpoints/checkpoint_epoch3_WPCA4096.pth.tar file...
Ignoring sequence length 3 for the im2im task. (Setting to 1)
=====> cph
=====> sf
all_recall@1: 0.689
all_recall@5: 0.803
all_recall@10: 0.846
all_recall@20: 0.876
all_map@1: 0.689
all_map@5: 0.510
all_map@10: 0.448
all_map@20: 0.429
